<html>
<meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, minimum-scale=1.0">
    <title>จองรถเบอร์.9</title>
    <link rel="shortcut icon" href="images/index.ico" type="image/x-icon">
 
    <!-- Font Awesome -->
    <link
    href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
    rel="stylesheet"
  />
  <!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Prompt:wght@600&display=swap" rel="stylesheet">
  <!-- MDB -->
  <link
    href="https://cdnjs.cloudflare.com/ajax/libs/mdb-ui-kit/4.4.0/mdb.min.css"
    rel="stylesheet"
  />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<head>
<style>
        body {
           font-family: 'Prompt' !important;
         }
        table, th, td 
        {
            margin:10px 0;
            border:solid 1px #333;
            padding:2px 4px;
            font:15px Verdana;
        }
        th {
            font-weight:bold;
        }
		

  #loader {
 border: 4px solid #f3f3f3;
  border-radius: 50%;
  border-top: 4px solid blue;
  border-right: 4px solid green;
  border-bottom: 4px solid red;
  border-left: 4px solid yellow;
  width: 30px;
  height: 30px;
  -webkit-animation: spin 0.5s linear infinite;
  animation: spin 0.5s linear infinite;
  visibility:hidden;
}

@-webkit-keyframes spin {
  0% { -webkit-transform: rotate(0deg); }
  100% { -webkit-transform: rotate(360deg); }
}

@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}
		
    </style>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.0/jquery.min.js"></script>
<script>
  
  var script_url = "https://script.google.com/macros/s/AKfycbym9AqXB1ccTO23Z5GJU_Y3PCsjvW_0BNwOhHNtYanIc17ZPARlqaxhCn9jcxVjfAX9JQ/exec";
  
//เพิ่มข้อมูล
  function insert_value() {
    
	$("#re").css("visibility","hidden");
	 document.getElementById("loader").style.visibility = "visible";
	$('#mySpinner').addClass('spinner');

    var firstname= $("#firstname").val();
    var dep= $("#dep").val();
    var car= $("#car").val();
    var loca= $("#loca").val();
    var date1= $("#date").val();
    var other= $("#other").val();
	var preapporved= $("#preapporved").val();
    var url = script_url+"?callback=ctrlq&preapporved="+preapporved+"&other="+other+"&date="+date1+"&loca="+loca+"&car="+car+"&dep="+dep+"&firstname="+firstname+"&action=insert";
  
    var request = jQuery.ajax({
      crossDomain: true,
      url: url ,
      method: "GET",
      dataType: "jsonp"
    });
  }
//อัปเดทข้อมูล
  function update_value(){
	$("#re").css("visibility","hidden");
     document.getElementById("loader").style.visibility = "visible";
	
     var id1= $("#firstname").val();
    var dep= $("#dep").val();
    var car= $("#car").val();
    var loca= $("#loca").val();
    var date= $("#date").val();
    var other= $("#other").val();
    var url = script_url+"?callback=ctrlq&other="+other+"&date="+date+"&loca="+loca+"&car="+car+"&dep="+dep+"&firstname="+firstname+"&action=update";
 
    var request = jQuery.ajax({
      crossDomain: true,
      url: url ,
      method: "GET",
      dataType: "jsonp"
    });
  }

//ลบข้อมูล
  function delete_value(){
	$("#re").css("visibility","hidden");
     document.getElementById("loader").style.visibility = "visible";
	 
	$('#mySpinner').addClass('spinner');
     var id1= $("#firstname").val();
    var dep= $("#dep").val();
    var car= $("#car").val();
    var loca= $("#loca").val();
    var date= $("#date").val();
    var other= $("#other").val();
    var url = script_url+"?callback=ctrlq&other="+other+"&date="+date+"&loca="+loca+"&car="+car+"&dep="+dep+"&firstname="+firstname+"&action=delete";

    var request = jQuery.ajax({
      crossDomain: true,
      url: url ,
      method: "GET",
      dataType: "jsonp"
    });
  }

  // print the returned data
  function ctrlq(e) {
	$("#re").html(e.result);
	$("#re").css("visibility","visible");
	read_value();
  }
  
function read_value() {

    $("#re").css("visibility","hidden");
    document.getElementById("loader").style.visibility = "visible";
    var url = script_url+"?action=read";

    $.getJSON(url, function (json) {
    // สร้างตารางแสดงข้อมูล
        var table = document.createElement("table");
        var header = table.createTHead();
		var row = header.insertRow(0);     
		var cell1 = row.insertCell(0);
		var cell2 = row.insertCell(1);
        var cell3 = row.insertCell(2);
        var cell4 = row.insertCell(3);
        var cell5 = row.insertCell(4);
        var cell6 = row.insertCell(5);
		row.style.background = "rgb(243,219,113)";
	
		        cell1.innerHTML = "<b>ชื่อผู้จอง</b>";
		        cell2.innerHTML = "<b>แผนก</b>";
                cell3.innerHTML = "<b>หมายเลขรถที่จอง</b>";
                cell4.innerHTML = "<b>สถานที่ๆไปติดต่อ</b>";
                cell5.innerHTML = "<b>วันและเวลาที่ต้องการจอง</b>";
                cell6.innerHTML = "<b>อื่นๆ</b>";
        
        //นำข้อมูลลงในตาราง
        for (var i = 0; i < json.records.length; i++) {
            tr = table.insertRow(-1);
		var tabCell = tr.insertCell(-1);
                tabCell.innerHTML = json.records[i].ชื่อผู้จอง;
		tabCell = tr.insertCell(-1);
		tabCell.innerHTML = json.records[i].แผนก;
                tabCell = tr.insertCell(-1);
		tabCell.innerHTML = json.records[i].หมายเลขรถที่จอง;
                tabCell = tr.insertCell(-1);
		tabCell.innerHTML = json.records[i].สถานที่ๆไปติดต่อ;
                tabCell = tr.insertCell(-1);
		tabCell.innerHTML = json.records[i].วันและเวลาที่ต้องการจอง;
                tabCell = tr.insertCell(-1);
		tabCell.innerHTML = json.records[i].อื่นๆ;
            }

        var divContainer = document.getElementById("showData");
        divContainer.innerHTML = "";
        divContainer.appendChild(table);
        document.getElementById("loader").style.visibility = "hidden";
	$("#re").css("visibility","visible");
	
        $("#firstname").val("")
	    $("#dep").val("")
        $("#car").val("")
        $("#loca").val("")
        $("#date").val("")
        $("#other").val("")
    });
	}
  </script>

  
</head>
<body>
<div class="container">
             <!-- space -->
                <div class="py-lg-4 py-md-4 py-sm-3 py-2"></div>
                <div class="row justify-content-center pt-1"> 
                    <div class="col-lg-6 col-md-10">
                        <h3 class="text-center" style="color: blue;">แบบฟอร์มจองรถเบอร์.9</h3>
 <br>

<!-- สร้างฟอร์ม -->
<form class="form_overlay" method="POST"> 
    <div class="row g-4">
        <div class="col-lg-6">
            <div class="input_overlay">
                <label for="firstname" class="lable">ชื่อผู้จอง</label>
                <input type="text" id="firstname" name="firstname" class="form-control" style="font-size: 19px;" required oninvalid="this.setCustomValidity('กรุณาป้อนชื่อของท่านด้วยครับ')">
            </div>
        </div>
       <div class="col-lg-6">
            <div class="input_overlay">
                <label for="dep" class="lable">แผนก</label>
                 <select class="form-select" id="dep" name="dep" aria-label="Default select example" required="">
    <option selected></option>
    <option value="PC">PC</option>
    <option value="HR">HR</option>
    <option value="FN">FN</option>
    <option value="AC">AC</option>
    <option value="SF">SF</option>
    <option value="ST">ST</option>
    <option value="MC">MC</option>
    <option value="PR">PR</option>
    <option value="QC">QC</option>
    <option value="PA">PA</option>
    <option value="IT">IT</option>
    <option value="DC">DC</option>
    <option value="R&D">R&D</option>
    <option value="RM">RM</option>
    <option value="EC">EC</option>
    <option value="O&E">O&E</option>
    <option value="AP">AP</option>
   </select>
            </div>
        </div>

        <div class="col-lg-6">
            <div class="input_overlay">
                <label for="car" class="lable">หมายเลขรถที่จอง</label>
                <select class="form-select" id="car" name="car" aria-label="Default select example" required="">
    <option selected></option>
    <option value="No.9ขับเอง">No.9ขับเอง</option>
    <option value="No.9พร้อมคนขับ">No.9พร้อมคนขับ</option>
     <option value="รถตู้">รถตู้</option>
    <option value="ฟอร์จูนเนอร์">ฟอร์จูนเนอร์</option>
    <option value="แคมรี่ขาว">แคมรี่ขาว</option>
    </select>
            </div>
        </div>

        <div class="col-lg-6">
            <div class="input_overlay">
                <label for="loca" class="lable">สถานที่ๆไปติดต่อ</label>
                <input type="text" id="loca" name="loca" class="form-control" style="font-size: 19px;" required="">
            </div>
        </div>

        <div class="col-lg-6">
            <div class="input_overlay">
                <label for="date" class="lable">วันและเวลาที่ต้องการจอง</label>
                <!-- <input type="text" id="date" name="date" class="form-control" required autocomplete="off"> -->
				 <select class="form-select" id="date" name="date" aria-label="Default select example" required="">
    <option selected></option>
    <option value="30/9/65 เช้า">30/9/65 เช้า</option>
    <option value="30/9/65 บ่าย">30/9/65 บ่าย</option>
    <option value="01/10/65 เช้า">01/10/65 เช้า</option>
    <option value="01/10/65 บ่าย">01/10/65 บ่าย</option>
    <option value="02/10/65 เช้า">02/10/65 เช้า</option>
    <option value="02/10/65 บ่าย">02/10/65 บ่าย</option>
    <option value="03/10/65 เช้า">03/10/65 เช้า</option>
    <option value="03/10/65 บ่าย">03/10/65 บ่าย</option>
    <option value="04/10/65 เช้า">04/10/65 เช้า</option>
    <option value="04/10/65 บ่าย">04/10/65 บ่าย</option>
    <option value="05/10/65 เช้า">05/10/65 เช้า</option>
    <option value="05/10/65 บ่าย">05/10/65 บ่าย</option>
    <option value="06/10/65 เช้า">06/10/65 เช้า</option>
    <option value="06/10/65 บ่าย">06/10/65 บ่าย</option>
    <option value="07/10/65 เช้า">07/10/65 เช้า</option>
    <option value="07/10/65 บ่าย">07/10/65 บ่าย</option>
    <option value="08/10/65 เช้า">08/10/65 เช้า</option>
    <option value="08/10/65 บ่าย">08/10/65 บ่าย</option>
    <option value="09/10/65 เช้า">09/10/65 เช้า</option>
    <option value="09/10/65 บ่าย">09/10/65 บ่าย</option>
    <option value="10/10/65 เช้า">10/10/65 เช้า</option>
    <option value="10/10/65 บ่าย">10/10/65 บ่าย</option>
    <option value="11/10/65 เช้า">11/10/65 เช้า</option>
    <option value="11/10/65 บ่าย">11/10/65 บ่าย</option>
    <option value="12/10/65 เช้า">12/10/65 เช้า</option>
    <option value="12/10/65 บ่าย">12/10/65 บ่าย</option>
    <option value="13/10/65 เช้า">13/10/65 เช้า</option>
    <option value="13/10/65 บ่าย">13/10/65 บ่าย</option>
    <option value="14/10/65 เช้า">14/10/65 เช้า</option>
    <option value="14/10/65 บ่าย">14/10/65 บ่าย</option>
    <option value="15/10/65 เช้า">15/10/65 เช้า</option>
    <option value="15/10/65 บ่าย">15/10/65 บ่าย</option>
    <option value="16/10/65 เช้า">16/10/65 เช้า</option>
    <option value="16/10/65 บ่าย">16/10/65 บ่าย</option>
    <option value="17/10/65 เช้า">17/10/65 เช้า</option>
    <option value="17/10/65 บ่าย">17/10/65 บ่าย</option>
    <option value="18/10/65 เช้า">18/10/65 เช้า</option>
    <option value="18/10/65 บ่าย">18/10/65 บ่าย</option>
    <option value="19/10/65 เช้า">19/10/65 เช้า</option>
    <option value="19/10/65 บ่าย">19/10/65 บ่าย</option>
    <option value="20/10/65 เช้า">20/10/65 เช้า</option>
    <option value="20/10/65 บ่าย">20/10/65 บ่าย</option>
    <option value="21/10/65 เช้า">21/10/65 เช้า</option>
    <option value="21/10/65 บ่าย">21/10/65 บ่าย</option>
    <option value="22/10/65 เช้า">22/10/65 เช้า</option>
    <option value="22/10/65 บ่าย">22/10/65 บ่าย</option>
    <option value="23/10/65 เช้า">23/10/65 เช้า</option>
    <option value="23/10/65 บ่าย">23/10/65 บ่าย</option>
    <option value="24/10/65 เช้า">24/10/65 เช้า</option>
    <option value="24/10/65 บ่าย">24/10/65 บ่าย</option>
    <option value="25/10/65 เช้า">25/10/65 เช้า</option>
    <option value="25/10/65 บ่าย">25/10/65 บ่าย</option>
    <option value="26/10/65 เช้า">26/10/65 เช้า</option>
    <option value="26/10/65 บ่าย">26/10/65 บ่าย</option>
    <option value="27/10/65 เช้า">27/10/65 เช้า</option>
    <option value="27/10/65 บ่าย">27/10/65 บ่าย</option>
    <option value="28/10/65 เช้า">28/10/65 เช้า</option>
    <option value="28/10/65 บ่าย">28/10/65 บ่าย</option>
    <option value="29/10/65 เช้า">29/10/65 เช้า</option>
    <option value="29/10/65 บ่าย">29/10/65 บ่าย</option>
    <option value="30/10/65 เช้า">30/10/65 เช้า</option>
    <option value="30/10/65 บ่าย">30/10/65 บ่าย</option>
    <option value="31/10/65 เช้า">31/10/65 เช้า</option>
    <option value="31/10/65 บ่าย">31/10/65 บ่าย</option>
    </select>
            </div>
        </div>

        <div class="col-lg-6">
            <div class="input_overlay">
                <label for="other" class="lable">อื่นๆ</label>
                <input type="text" id="other" name="other" class="form-control" style="font-size: 19px;">
            </div>
        </div>
		
		 <input type="text" class="input" id="preapporved" name="preapporved" value ="รออนุมัติ" style="display: none;">
		  
		 <!-- เรียกตัว loder มาแสดง-->
<center><div id="loader"></div></center>
<center><p id="re">กรุณารอผลการจอง</p></center>

                   <div class="col-12 text-center">
                        <input type = "submit" class="btn btn-primary mt-3" 
                         id = "b1" onClick="insert_value()" value = "เพิ่มข้อมูล" ></input>
                   </div>
    </form>
   


 

<!--<input type="button" style="font-size:12pt;color:white;background-color:#6DA551;border:1px solid #000000;padding:2px" 
onclick="read_value()" value="แสดงข้อมูล" />
<input type="button" style="font-size:12pt;color:white;background-color:#0298F7;border:1px solid #000000;padding:2px" 
onclick="update_value()" value="อัปเดทข้อมูล" />
<input type="button" style="font-size:12pt;color:white;background-color:#975AE0;border:1px solid #000000;padding:2px" 
onclick="delete_value()" value="ลบข้อมูล" />-->

<!-- <br><br>
<center><a href="https://docs.google.com/spreadsheets/d/13NHCnnmSunJqaljVGodjrRMT5gnr02rATE35hl9mu-o/edit?usp=sharing" target="_blank">ดูข้อมูลในชีต</a></center> -->
<div id="showData"></div>
</div>

 </div>
 </div>
 </div>
<script>

</script>
<script src="//cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>

</body>

<html>
